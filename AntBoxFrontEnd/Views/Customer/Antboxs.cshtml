@model AntBoxFrontEnd.Services.AntBoxes.PaginationAntBoxes
@{
    ViewBag.Title = "Index";
}
<!-- WRAPPER -->
<div class="wrapper">
    <!-- CONTENT -->
    <div class="content mis_antboxs">
        <!-- CONTAINER -->
        <div class="container">
            <div class="row irow-xs">
                <div class="col-sm-12">
                    <h1>Mis Antboxs</h1>
                    <div class="heading-divider"></div>
                </div>
            </div>
        </div>
        <!-- /.container -->
        <!-- CONTAINER -->
        <div class="container mt30">
            @Html.Hidden("idpagination", @Model.Pagination_id)
            @Html.Hidden("total", @Model.Total)
            @Html.Hidden("pages", @Model.Pages)
            <div class="row">
                <div class="col-md-3 pr0 no_portrait">
                    @Html.Partial("_LeftMenu")
                </div>
                <div class="col-md-9">
                    <div class="row">
                        <div class="irow-xs pb30 pl30 pr30">
                            <h3>Mis Antboxs almacenados</h3>
                            <p>Programa la solicitud de tus Antboxs en el momento que tú decidas. Agrega una descripción que te permita identificar su contenido fácilmente.</p>
                        </div>
                        @Html.Partial("_CustomerAntboxs", Model.Antboxs)
                    </div>
                    <div class="pagination solid text-center"></div>
                    <div class"row">
                        <div class="col-sm-12 pl0 pr0 pt20 text-center">
                            <!-- PAGINATION -->
                            
                            <!-- /.pagination -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.container -->
    </div>
    <!-- /.content -->
    <?php include 'includes/promobox.php';?>

</div>
<!-- /.wrapper -->
<?php include 'includes/footer.php';?>

<!-- Modal Small -->
<div class="modal fade" id="editar">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i></button>
                <h6 class="modal-title">Editar mi Antboxs</h6>
            </div>
            <div class="modal-body">
                <form action="../../php/email.php" method="post" class="contact-form form-solid form-editar-antbox" novalidate>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="form-group">
                                <label for="mname-antbox">Nombre de mi Antboxs</label>
                                <input type="text" name="mname-antbox" id="mname-antbox" placeholder="Mi Antbox">
                            </div>
                            <div class="form-group">
                                <label for="mdescription-antbox">Descripción</label>
                                <textarea name="mdescription-antbox" id="mdescription-antbox"></textarea>
                            </div>
                        </div>
                        <div class="col-sm-12 mt10">
                            <input type="submit" class="btn btn-primary btn-wide pull-right guardar-antbox" value="Guardar">
                            <p class="succs-msg">Мensaje enviado</p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- /.modal -->
<!-- Modal Medium -->
<div class="modal fade" id="solicitar">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><i class="fa fa-times"></i></button>
                <h6 class="modal-title">Solicitar mi Antboxs</h6>
            </div>
            <div class="modal-body">
                <form action="../../php/email.php" method="post" class="contact-form form-solid" novalidate>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group mb0">
                                <label for="form-select">Dirección de entrega</label>
                                <select id="form-select">
                                    <option value>- Selecciona una opción -</option>
                                    <option value="Casa">Casa</option>
                                    <option value="Oficina">Oficina</option>
                                    <option value="Facturación">Facturación</option>
                                </select>
                                <a href="direcciones.php" class="pull-right">Nueva dirección</a>
                            </div>
                            <label for="textbox">Fecha</label>
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <button type="button" id="entrega" class="btn btn-primary pull-right"><i class="fa fa-calendar"></i></button>
                                </span>
                                <input class="form-control" type="text" id="fecha_entrega" name="fecha_entrega" disabled="disable">
                            </div>
                            <div class="form-group">
                                <label for="form-select">Horario de entrega</label>
                                <select id="form-select">
                                    <option value>- Selecciona una opción -</option>
                                    <option value="09-11">09:00 - 11:00 hrs.</option>
                                    <option value="11-13">11:00 - 13:00 hrs.</option>
                                    <option value="13-15">13:00 - 15:00 hrs.</option>
                                    <option value="15-17">15:00 - 17:00 hrs.</option>
                                    <option value="17-19">17:00 - 19:00 hrs.</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-sm-6 pl0_modal">
                            <div class="form-group">
                                <label for="form-message">Referencias o comentarios</label>
                                <textarea name="message" id="form-message"></textarea>
                            </div>
                        </div>
                        <div class="col-sm-12 mt10">
                            <input type="button" class="btn btn-primary btn-wide pull-right" value="Solicitar">
                            <p class="succs-msg">Мensaje enviado</p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- /.modal -->

@section css {
    @Styles.Render("~/Content/simplepaginationcss")
}

@section scripts {
@Scripts.Render("~/bundles/simplepaginationjs")
<script type="text/javascript">
    Calendar.setup({
        inputField     :    "fecha_entrega",      // id del campo de texto
        ifFormat       :    "%Y-%m-%d",       // formato de la fecha, cuando se escriba en el campo de texto
        button         :    "entrega"   // el id del botón que lanzará el calendario
    });
    $(function () {
        //editar andbox
        var element = null;
        var ideditar = null;
        $('.editar').click(function () {
            element = $(this);
            var name = element.parent().find('.name-antbox').text();
            var description = element.parent().find('.description-antbox').text();
            var ideditar = element.attr('data-id');

            if (name != "Mi Antbox") $('#mname-antbox').val(name);
            else $('#mname-antbox').val('');

            if (description != "" || description != "Descripci�n") $('#mdescription-antbox').val(description);
            else $('#mdescription-antbox').val('');
        });

        $('.guardar-antbox').click(function (event) {
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: '@Url.Action("UpdateAjax", "AntBox")',
            data: { id: element.attr('data-id'), name: $('#mname-antbox').val(), description: $('#mdescription-antbox').val() },
            success: function (result) {
                if (result.success == true) {
                    //antbox editado
                    if (!$('#UpdateAntBoxSuccess').length)
                    {
                        $('.form-editar-antbox').prepend('<div class="alert alert-success alert-dismissible fade in" id="UpdateAntBoxSuccess"> <button type="button" class="close" data-dismiss="alert"> <i class="fa fa-times"></i></button><p><i class="fa fa-check"></i>Se ha actualizado la información.</p></div>');
                        window.setTimeout(function () {
                            $('#UpdateAntBoxSuccess').hide();
                        }, 3000);
                        window.setTimeout(function () {
                            $('#mname-antbox').val('');
                            $('#mdescription-antbox').val('');
                            $('#editar').modal('hide');
                        }, 500);
                    }
                    element.parent().find('.name-antbox').text($('#mname-antbox').val());
                    element.parent().find('.description-antbox').text($('#mdescription-antbox').val());
                } else {

                }
            }
        });
    });

    $('.pagination').pagination({
        items: $('#total').val(),
        itemsOnPage: 20,
        cssStyle: 'light-theme',
        onPageClick: function (pageNumber, event) {
            event.preventDefault();
            alert(pageNumber);

            var formData = { idPagination : $('#idpagination').val(), page: pageNumber };

            $.ajax({
                type: 'POST',
                url: '@Url.Action("PaginationAjax", "AntBox")',
                data: formData,
                success: function (result) {
                    console.log(result);
                }
            });

        }
    });
})
</script>
}